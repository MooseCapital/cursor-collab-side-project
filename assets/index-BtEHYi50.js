var Ni=Object.defineProperty;var Oi=(t,n,e)=>n in t?Ni(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var vn=(t,n,e)=>Oi(t,typeof n!="symbol"?n+"":n,e);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();function Cn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Bi(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function lt(t,...n){if(!Bi(t))throw new Error("Uint8Array expected");if(n.length>0&&!n.includes(t.length))throw new Error("Uint8Array expected of length "+n+", got length="+t.length)}function Li(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Cn(t.outputLen),Cn(t.blockLen)}function st(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")}function Di(t,n){lt(t);const e=n.outputLen;if(t.length<e)throw new Error("digestInto() expects output buffer of length at least "+e)}const Le=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const bt=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),he=(t,n)=>t<<32-n|t>>>n;function ki(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Zt(t){return typeof t=="string"&&(t=ki(t)),lt(t),t}function Fi(...t){let n=0;for(let r=0;r<t.length;r++){const s=t[r];lt(s),n+=s.length}const e=new Uint8Array(n);for(let r=0,s=0;r<t.length;r++){const o=t[r];e.set(o,s),s+=o.length}return e}class or{clone(){return this._cloneInto()}}function Pi(t){const n=r=>t().update(Zt(r)).digest(),e=t();return n.outputLen=e.outputLen,n.blockLen=e.blockLen,n.create=()=>t(),n}function ar(t=32){if(Le&&typeof Le.getRandomValues=="function")return Le.getRandomValues(new Uint8Array(t));if(Le&&typeof Le.randomBytes=="function")return Le.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function Ui(t,n,e,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(n,e,r);const s=BigInt(32),o=BigInt(4294967295),a=Number(e>>s&o),u=Number(e&o),c=r?4:0,h=r?0:4;t.setUint32(n+c,a,r),t.setUint32(n+h,u,r)}const qi=(t,n,e)=>t&n^~t&e,Mi=(t,n,e)=>t&n^t&e^n&e;class ji extends or{constructor(n,e,r,s){super(),this.blockLen=n,this.outputLen=e,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(n),this.view=bt(this.buffer)}update(n){st(this);const{view:e,buffer:r,blockLen:s}=this;n=Zt(n);const o=n.length;for(let a=0;a<o;){const u=Math.min(s-this.pos,o-a);if(u===s){const c=bt(n);for(;s<=o-a;a+=s)this.process(c,a);continue}r.set(n.subarray(a,a+u),this.pos),this.pos+=u,a+=u,this.pos===s&&(this.process(e,0),this.pos=0)}return this.length+=n.length,this.roundClean(),this}digestInto(n){st(this),Di(n,this),this.finished=!0;const{buffer:e,view:r,blockLen:s,isLE:o}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>s-a&&(this.process(r,0),a=0);for(let l=a;l<s;l++)e[l]=0;Ui(r,s-8,BigInt(this.length*8),o),this.process(r,0);const u=bt(n),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const h=c/4,f=this.get();if(h>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<h;l++)u.setUint32(4*l,f[l],o)}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const r=n.slice(0,e);return this.destroy(),r}_cloneInto(n){n||(n=new this.constructor),n.set(...this.get());const{blockLen:e,buffer:r,length:s,finished:o,destroyed:a,pos:u}=this;return n.length=s,n.pos=u,n.finished=o,n.destroyed=a,s%e&&n.buffer.set(r),n}}const Hi=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ve=new Uint32Array(64);class Wi extends ji{constructor(){super(64,32,8,!1),this.A=xe[0]|0,this.B=xe[1]|0,this.C=xe[2]|0,this.D=xe[3]|0,this.E=xe[4]|0,this.F=xe[5]|0,this.G=xe[6]|0,this.H=xe[7]|0}get(){const{A:n,B:e,C:r,D:s,E:o,F:a,G:u,H:c}=this;return[n,e,r,s,o,a,u,c]}set(n,e,r,s,o,a,u,c){this.A=n|0,this.B=e|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=a|0,this.G=u|0,this.H=c|0}process(n,e){for(let l=0;l<16;l++,e+=4)ve[l]=n.getUint32(e,!1);for(let l=16;l<64;l++){const d=ve[l-15],E=ve[l-2],T=he(d,7)^he(d,18)^d>>>3,C=he(E,17)^he(E,19)^E>>>10;ve[l]=C+ve[l-7]+T+ve[l-16]|0}let{A:r,B:s,C:o,D:a,E:u,F:c,G:h,H:f}=this;for(let l=0;l<64;l++){const d=he(u,6)^he(u,11)^he(u,25),E=f+d+qi(u,c,h)+Hi[l]+ve[l]|0,C=(he(r,2)^he(r,13)^he(r,22))+Mi(r,s,o)|0;f=h,h=c,c=u,u=a+E|0,a=o,o=s,s=r,r=E+C|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,a=a+this.D|0,u=u+this.E|0,c=c+this.F|0,h=h+this.G|0,f=f+this.H|0,this.set(r,s,o,a,u,c,h,f)}roundClean(){ve.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Ut=Pi(()=>new Wi);class cr extends or{constructor(n,e){super(),this.finished=!1,this.destroyed=!1,Li(n);const r=Zt(e);if(this.iHash=n.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(r.length>s?n.create().update(r).digest():r);for(let a=0;a<o.length;a++)o[a]^=54;this.iHash.update(o),this.oHash=n.create();for(let a=0;a<o.length;a++)o[a]^=106;this.oHash.update(o),o.fill(0)}update(n){return st(this),this.iHash.update(n),this}digestInto(n){st(this),lt(n,this.outputLen),this.finished=!0,this.iHash.digestInto(n),this.oHash.update(n),this.oHash.digestInto(n),this.destroy()}digest(){const n=new Uint8Array(this.oHash.outputLen);return this.digestInto(n),n}_cloneInto(n){n||(n=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:s,destroyed:o,blockLen:a,outputLen:u}=this;return n=n,n.finished=s,n.destroyed=o,n.blockLen=a,n.outputLen=u,n.oHash=e._cloneInto(n.oHash),n.iHash=r._cloneInto(n.iHash),n}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ur=(t,n,e)=>new cr(t,n).update(e).digest();ur.create=(t,n)=>new cr(t,n);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ft=BigInt(0),dt=BigInt(1),zi=BigInt(2);function Ne(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function $e(t){if(!Ne(t))throw new Error("Uint8Array expected")}function Fe(t,n){if(typeof n!="boolean")throw new Error(t+" boolean expected, got "+n)}const Gi=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function Pe(t){$e(t);let n="";for(let e=0;e<t.length;e++)n+=Gi[t[e]];return n}function De(t){const n=t.toString(16);return n.length&1?"0"+n:n}function Xt(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?ft:BigInt("0x"+t)}const _e={_0:48,_9:57,A:65,F:70,a:97,f:102};function An(t){if(t>=_e._0&&t<=_e._9)return t-_e._0;if(t>=_e.A&&t<=_e.F)return t-(_e.A-10);if(t>=_e.a&&t<=_e.f)return t-(_e.a-10)}function Ue(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const n=t.length,e=n/2;if(n%2)throw new Error("hex string expected, got unpadded hex of length "+n);const r=new Uint8Array(e);for(let s=0,o=0;s<e;s++,o+=2){const a=An(t.charCodeAt(o)),u=An(t.charCodeAt(o+1));if(a===void 0||u===void 0){const c=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}r[s]=a*16+u}return r}function ye(t){return Xt(Pe(t))}function Qt(t){return $e(t),Xt(Pe(Uint8Array.from(t).reverse()))}function Te(t,n){return Ue(t.toString(16).padStart(n*2,"0"))}function Jt(t,n){return Te(t,n).reverse()}function Vi(t){return Ue(De(t))}function J(t,n,e){let r;if(typeof n=="string")try{r=Ue(n)}catch(o){throw new Error(t+" must be hex string or Uint8Array, cause: "+o)}else if(Ne(n))r=Uint8Array.from(n);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof e=="number"&&s!==e)throw new Error(t+" of length "+e+" expected, got "+s);return r}function Oe(...t){let n=0;for(let r=0;r<t.length;r++){const s=t[r];$e(s),n+=s.length}const e=new Uint8Array(n);for(let r=0,s=0;r<t.length;r++){const o=t[r];e.set(o,s),s+=o.length}return e}function Yi(t,n){if(t.length!==n.length)return!1;let e=0;for(let r=0;r<t.length;r++)e|=t[r]^n[r];return e===0}function Ki(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const yt=t=>typeof t=="bigint"&&ft<=t;function qe(t,n,e){return yt(t)&&yt(n)&&yt(e)&&n<=t&&t<e}function Ae(t,n,e,r){if(!qe(n,e,r))throw new Error("expected valid "+t+": "+e+" <= n < "+r+", got "+n)}function lr(t){let n;for(n=0;t>ft;t>>=dt,n+=1);return n}function $i(t,n){return t>>BigInt(n)&dt}function Zi(t,n,e){return t|(e?dt:ft)<<BigInt(n)}const en=t=>(zi<<BigInt(t-1))-dt,wt=t=>new Uint8Array(t),Tn=t=>Uint8Array.from(t);function fr(t,n,e){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof n!="number"||n<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let r=wt(t),s=wt(t),o=0;const a=()=>{r.fill(1),s.fill(0),o=0},u=(...l)=>e(s,r,...l),c=(l=wt())=>{s=u(Tn([0]),l),r=u(),l.length!==0&&(s=u(Tn([1]),l),r=u())},h=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const d=[];for(;l<n;){r=u();const E=r.slice();d.push(E),l+=r.length}return Oe(...d)};return(l,d)=>{a(),c(l);let E;for(;!(E=d(h()));)c();return a(),E}}const Xi={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Ne(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,n)=>n.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Ze(t,n,e={}){const r=(s,o,a)=>{const u=Xi[o];if(typeof u!="function")throw new Error("invalid validator function");const c=t[s];if(!(a&&c===void 0)&&!u(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+o+", got "+c)};for(const[s,o]of Object.entries(n))r(s,o,!1);for(const[s,o]of Object.entries(e))r(s,o,!0);return t}const Qi=()=>{throw new Error("not implemented")};function qt(t){const n=new WeakMap;return(e,...r)=>{const s=n.get(e);if(s!==void 0)return s;const o=t(e,...r);return n.set(e,o),o}}const Ji=Object.freeze(Object.defineProperty({__proto__:null,aInRange:Ae,abool:Fe,abytes:$e,bitGet:$i,bitLen:lr,bitMask:en,bitSet:Zi,bytesToHex:Pe,bytesToNumberBE:ye,bytesToNumberLE:Qt,concatBytes:Oe,createHmacDrbg:fr,ensureBytes:J,equalBytes:Yi,hexToBytes:Ue,hexToNumber:Xt,inRange:qe,isBytes:Ne,memoized:qt,notImplemented:Qi,numberToBytesBE:Te,numberToBytesLE:Jt,numberToHexUnpadded:De,numberToVarBytesBE:Vi,utf8ToBytes:Ki,validateObject:Ze},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Y=BigInt(0),z=BigInt(1),Ie=BigInt(2),es=BigInt(3),Mt=BigInt(4),Rn=BigInt(5),In=BigInt(8);function X(t,n){const e=t%n;return e>=Y?e:n+e}function ts(t,n,e){if(n<Y)throw new Error("invalid exponent, negatives unsupported");if(e<=Y)throw new Error("invalid modulus");if(e===z)return Y;let r=z;for(;n>Y;)n&z&&(r=r*t%e),t=t*t%e,n>>=z;return r}function ae(t,n,e){let r=t;for(;n-- >Y;)r*=r,r%=e;return r}function jt(t,n){if(t===Y)throw new Error("invert: expected non-zero number");if(n<=Y)throw new Error("invert: expected positive modulus, got "+n);let e=X(t,n),r=n,s=Y,o=z;for(;e!==Y;){const u=r/e,c=r%e,h=s-o*u;r=e,e=c,s=o,o=h}if(r!==z)throw new Error("invert: does not exist");return X(s,n)}function ns(t){const n=(t-z)/Ie;let e,r,s;for(e=t-z,r=0;e%Ie===Y;e/=Ie,r++);for(s=Ie;s<t&&ts(s,n,t)!==t-z;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const a=(t+z)/Mt;return function(c,h){const f=c.pow(h,a);if(!c.eql(c.sqr(f),h))throw new Error("Cannot find square root");return f}}const o=(e+z)/Ie;return function(u,c){if(u.pow(c,n)===u.neg(u.ONE))throw new Error("Cannot find square root");let h=r,f=u.pow(u.mul(u.ONE,s),e),l=u.pow(c,o),d=u.pow(c,e);for(;!u.eql(d,u.ONE);){if(u.eql(d,u.ZERO))return u.ZERO;let E=1;for(let C=u.sqr(d);E<h&&!u.eql(C,u.ONE);E++)C=u.sqr(C);const T=u.pow(f,z<<BigInt(h-E-1));f=u.sqr(T),l=u.mul(l,T),d=u.mul(d,f),h=E}return l}}function rs(t){if(t%Mt===es){const n=(t+z)/Mt;return function(r,s){const o=r.pow(s,n);if(!r.eql(r.sqr(o),s))throw new Error("Cannot find square root");return o}}if(t%In===Rn){const n=(t-Rn)/In;return function(r,s){const o=r.mul(s,Ie),a=r.pow(o,n),u=r.mul(s,a),c=r.mul(r.mul(u,Ie),a),h=r.mul(u,r.sub(c,r.ONE));if(!r.eql(r.sqr(h),s))throw new Error("Cannot find square root");return h}}return ns(t)}const is=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ss(t){const n={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=is.reduce((r,s)=>(r[s]="function",r),n);return Ze(t,e)}function os(t,n,e){if(e<Y)throw new Error("invalid exponent, negatives unsupported");if(e===Y)return t.ONE;if(e===z)return n;let r=t.ONE,s=n;for(;e>Y;)e&z&&(r=t.mul(r,s)),s=t.sqr(s),e>>=z;return r}function as(t,n){const e=new Array(n.length),r=n.reduce((o,a,u)=>t.is0(a)?o:(e[u]=o,t.mul(o,a)),t.ONE),s=t.inv(r);return n.reduceRight((o,a,u)=>t.is0(a)?o:(e[u]=t.mul(o,e[u]),t.mul(o,a)),s),e}function dr(t,n){const e=n!==void 0?n:t.toString(2).length,r=Math.ceil(e/8);return{nBitLength:e,nByteLength:r}}function hr(t,n,e=!1,r={}){if(t<=Y)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:o}=dr(t,n);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let a;const u=Object.freeze({ORDER:t,BITS:s,BYTES:o,MASK:en(s),ZERO:Y,ONE:z,create:c=>X(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Y<=c&&c<t},is0:c=>c===Y,isOdd:c=>(c&z)===z,neg:c=>X(-c,t),eql:(c,h)=>c===h,sqr:c=>X(c*c,t),add:(c,h)=>X(c+h,t),sub:(c,h)=>X(c-h,t),mul:(c,h)=>X(c*h,t),pow:(c,h)=>os(u,c,h),div:(c,h)=>X(c*jt(h,t),t),sqrN:c=>c*c,addN:(c,h)=>c+h,subN:(c,h)=>c-h,mulN:(c,h)=>c*h,inv:c=>jt(c,t),sqrt:r.sqrt||(c=>(a||(a=rs(t)),a(u,c))),invertBatch:c=>as(u,c),cmov:(c,h,f)=>f?h:c,toBytes:c=>e?Jt(c,o):Te(c,o),fromBytes:c=>{if(c.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+c.length);return e?Qt(c):ye(c)}});return Object.freeze(u)}function pr(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const n=t.toString(2).length;return Math.ceil(n/8)}function gr(t){const n=pr(t);return n+Math.ceil(n/2)}function cs(t,n,e=!1){const r=t.length,s=pr(n),o=gr(n);if(r<16||r<o||r>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+r);const a=e?ye(t):Qt(t),u=X(a,n-z)+z;return e?Jt(u,s):Te(u,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Nn=BigInt(0),tt=BigInt(1);function Et(t,n){const e=n.negate();return t?e:n}function _r(t,n){if(!Number.isSafeInteger(t)||t<=0||t>n)throw new Error("invalid window size, expected [1.."+n+"], got W="+t)}function St(t,n){_r(t,n);const e=Math.ceil(n/t)+1,r=2**(t-1);return{windows:e,windowSize:r}}function us(t,n){if(!Array.isArray(t))throw new Error("array expected");t.forEach((e,r)=>{if(!(e instanceof n))throw new Error("invalid point at index "+r)})}function ls(t,n){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((e,r)=>{if(!n.isValid(e))throw new Error("invalid scalar at index "+r)})}const xt=new WeakMap,mr=new WeakMap;function vt(t){return mr.get(t)||1}function fs(t,n){return{constTimeNegate:Et,hasPrecomputes(e){return vt(e)!==1},unsafeLadder(e,r,s=t.ZERO){let o=e;for(;r>Nn;)r&tt&&(s=s.add(o)),o=o.double(),r>>=tt;return s},precomputeWindow(e,r){const{windows:s,windowSize:o}=St(r,n),a=[];let u=e,c=u;for(let h=0;h<s;h++){c=u,a.push(c);for(let f=1;f<o;f++)c=c.add(u),a.push(c);u=c.double()}return a},wNAF(e,r,s){const{windows:o,windowSize:a}=St(e,n);let u=t.ZERO,c=t.BASE;const h=BigInt(2**e-1),f=2**e,l=BigInt(e);for(let d=0;d<o;d++){const E=d*a;let T=Number(s&h);s>>=l,T>a&&(T-=f,s+=tt);const C=E,_=E+Math.abs(T)-1,S=d%2!==0,R=T<0;T===0?c=c.add(Et(S,r[C])):u=u.add(Et(R,r[_]))}return{p:u,f:c}},wNAFUnsafe(e,r,s,o=t.ZERO){const{windows:a,windowSize:u}=St(e,n),c=BigInt(2**e-1),h=2**e,f=BigInt(e);for(let l=0;l<a;l++){const d=l*u;if(s===Nn)break;let E=Number(s&c);if(s>>=f,E>u&&(E-=h,s+=tt),E===0)continue;let T=r[d+Math.abs(E)-1];E<0&&(T=T.negate()),o=o.add(T)}return o},getPrecomputes(e,r,s){let o=xt.get(r);return o||(o=this.precomputeWindow(r,e),e!==1&&xt.set(r,s(o))),o},wNAFCached(e,r,s){const o=vt(e);return this.wNAF(o,this.getPrecomputes(o,e,s),r)},wNAFCachedUnsafe(e,r,s,o){const a=vt(e);return a===1?this.unsafeLadder(e,r,o):this.wNAFUnsafe(a,this.getPrecomputes(a,e,s),r,o)},setWindowSize(e,r){_r(r,n),mr.set(e,r),xt.delete(e)}}}function ds(t,n,e,r){if(us(e,t),ls(r,n),e.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,o=lr(BigInt(e.length)),a=o>12?o-3:o>4?o-2:o?2:1,u=(1<<a)-1,c=new Array(u+1).fill(s),h=Math.floor((n.BITS-1)/a)*a;let f=s;for(let l=h;l>=0;l-=a){c.fill(s);for(let E=0;E<r.length;E++){const T=r[E],C=Number(T>>BigInt(l)&BigInt(u));c[C]=c[C].add(e[E])}let d=s;for(let E=c.length-1,T=s;E>0;E--)T=T.add(c[E]),d=d.add(T);if(f=f.add(d),l!==0)for(let E=0;E<a;E++)f=f.double()}return f}function br(t){return ss(t.Fp),Ze(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...dr(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function On(t){t.lowS!==void 0&&Fe("lowS",t.lowS),t.prehash!==void 0&&Fe("prehash",t.prehash)}function hs(t){const n=br(t);Ze(n,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:e,Fp:r,a:s}=n;if(e){if(!r.eql(s,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...n})}const{bytesToNumberBE:ps,hexToBytes:gs}=Ji,me={Err:class extends Error{constructor(n=""){super(n)}},_tlv:{encode:(t,n)=>{const{Err:e}=me;if(t<0||t>256)throw new e("tlv.encode: wrong tag");if(n.length&1)throw new e("tlv.encode: unpadded data");const r=n.length/2,s=De(r);if(s.length/2&128)throw new e("tlv.encode: long form length too big");const o=r>127?De(s.length/2|128):"";return De(t)+o+s+n},decode(t,n){const{Err:e}=me;let r=0;if(t<0||t>256)throw new e("tlv.encode: wrong tag");if(n.length<2||n[r++]!==t)throw new e("tlv.decode: wrong tlv");const s=n[r++],o=!!(s&128);let a=0;if(!o)a=s;else{const c=s&127;if(!c)throw new e("tlv.decode(long): indefinite length not supported");if(c>4)throw new e("tlv.decode(long): byte length is too big");const h=n.subarray(r,r+c);if(h.length!==c)throw new e("tlv.decode: length bytes not complete");if(h[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(const f of h)a=a<<8|f;if(r+=c,a<128)throw new e("tlv.decode(long): not minimal encoding")}const u=n.subarray(r,r+a);if(u.length!==a)throw new e("tlv.decode: wrong value length");return{v:u,l:n.subarray(r+a)}}},_int:{encode(t){const{Err:n}=me;if(t<be)throw new n("integer: negative integers are not allowed");let e=De(t);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new n("unexpected DER parsing assertion: unpadded hex");return e},decode(t){const{Err:n}=me;if(t[0]&128)throw new n("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new n("invalid signature integer: unnecessary leading zero");return ps(t)}},toSig(t){const{Err:n,_int:e,_tlv:r}=me,s=typeof t=="string"?gs(t):t;$e(s);const{v:o,l:a}=r.decode(48,s);if(a.length)throw new n("invalid signature: left bytes after parsing");const{v:u,l:c}=r.decode(2,o),{v:h,l:f}=r.decode(2,c);if(f.length)throw new n("invalid signature: left bytes after parsing");return{r:e.decode(u),s:e.decode(h)}},hexFromSig(t){const{_tlv:n,_int:e}=me,r=n.encode(2,e.encode(t.r)),s=n.encode(2,e.encode(t.s)),o=r+s;return n.encode(48,o)}},be=BigInt(0),V=BigInt(1);BigInt(2);const Bn=BigInt(3);BigInt(4);function _s(t){const n=hs(t),{Fp:e}=n,r=hr(n.n,n.nBitLength),s=n.toBytes||((C,_,S)=>{const R=_.toAffine();return Oe(Uint8Array.from([4]),e.toBytes(R.x),e.toBytes(R.y))}),o=n.fromBytes||(C=>{const _=C.subarray(1),S=e.fromBytes(_.subarray(0,e.BYTES)),R=e.fromBytes(_.subarray(e.BYTES,2*e.BYTES));return{x:S,y:R}});function a(C){const{a:_,b:S}=n,R=e.sqr(C),N=e.mul(R,C);return e.add(e.add(N,e.mul(C,_)),S)}if(!e.eql(e.sqr(n.Gy),a(n.Gx)))throw new Error("bad generator point: equation left != right");function u(C){return qe(C,V,n.n)}function c(C){const{allowedPrivateKeyLengths:_,nByteLength:S,wrapPrivateKey:R,n:N}=n;if(_&&typeof C!="bigint"){if(Ne(C)&&(C=Pe(C)),typeof C!="string"||!_.includes(C.length))throw new Error("invalid private key");C=C.padStart(S*2,"0")}let m;try{m=typeof C=="bigint"?C:ye(J("private key",C,S))}catch{throw new Error("invalid private key, expected hex or "+S+" bytes, got "+typeof C)}return R&&(m=X(m,N)),Ae("private key",m,V,N),m}function h(C){if(!(C instanceof d))throw new Error("ProjectivePoint expected")}const f=qt((C,_)=>{const{px:S,py:R,pz:N}=C;if(e.eql(N,e.ONE))return{x:S,y:R};const m=C.is0();_==null&&(_=m?e.ONE:e.inv(N));const g=e.mul(S,_),p=e.mul(R,_),b=e.mul(N,_);if(m)return{x:e.ZERO,y:e.ZERO};if(!e.eql(b,e.ONE))throw new Error("invZ was invalid");return{x:g,y:p}}),l=qt(C=>{if(C.is0()){if(n.allowInfinityPoint&&!e.is0(C.py))return;throw new Error("bad point: ZERO")}const{x:_,y:S}=C.toAffine();if(!e.isValid(_)||!e.isValid(S))throw new Error("bad point: x or y not FE");const R=e.sqr(S),N=a(_);if(!e.eql(R,N))throw new Error("bad point: equation left != right");if(!C.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class d{constructor(_,S,R){if(this.px=_,this.py=S,this.pz=R,_==null||!e.isValid(_))throw new Error("x required");if(S==null||!e.isValid(S))throw new Error("y required");if(R==null||!e.isValid(R))throw new Error("z required");Object.freeze(this)}static fromAffine(_){const{x:S,y:R}=_||{};if(!_||!e.isValid(S)||!e.isValid(R))throw new Error("invalid affine point");if(_ instanceof d)throw new Error("projective point not allowed");const N=m=>e.eql(m,e.ZERO);return N(S)&&N(R)?d.ZERO:new d(S,R,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){const S=e.invertBatch(_.map(R=>R.pz));return _.map((R,N)=>R.toAffine(S[N])).map(d.fromAffine)}static fromHex(_){const S=d.fromAffine(o(J("pointHex",_)));return S.assertValidity(),S}static fromPrivateKey(_){return d.BASE.multiply(c(_))}static msm(_,S){return ds(d,r,_,S)}_setWindowSize(_){T.setWindowSize(this,_)}assertValidity(){l(this)}hasEvenY(){const{y:_}=this.toAffine();if(e.isOdd)return!e.isOdd(_);throw new Error("Field doesn't support isOdd")}equals(_){h(_);const{px:S,py:R,pz:N}=this,{px:m,py:g,pz:p}=_,b=e.eql(e.mul(S,p),e.mul(m,N)),y=e.eql(e.mul(R,p),e.mul(g,N));return b&&y}negate(){return new d(this.px,e.neg(this.py),this.pz)}double(){const{a:_,b:S}=n,R=e.mul(S,Bn),{px:N,py:m,pz:g}=this;let p=e.ZERO,b=e.ZERO,y=e.ZERO,v=e.mul(N,N),I=e.mul(m,m),D=e.mul(g,g),F=e.mul(N,m);return F=e.add(F,F),y=e.mul(N,g),y=e.add(y,y),p=e.mul(_,y),b=e.mul(R,D),b=e.add(p,b),p=e.sub(I,b),b=e.add(I,b),b=e.mul(p,b),p=e.mul(F,p),y=e.mul(R,y),D=e.mul(_,D),F=e.sub(v,D),F=e.mul(_,F),F=e.add(F,y),y=e.add(v,v),v=e.add(y,v),v=e.add(v,D),v=e.mul(v,F),b=e.add(b,v),D=e.mul(m,g),D=e.add(D,D),v=e.mul(D,F),p=e.sub(p,v),y=e.mul(D,I),y=e.add(y,y),y=e.add(y,y),new d(p,b,y)}add(_){h(_);const{px:S,py:R,pz:N}=this,{px:m,py:g,pz:p}=_;let b=e.ZERO,y=e.ZERO,v=e.ZERO;const I=n.a,D=e.mul(n.b,Bn);let F=e.mul(S,m),G=e.mul(R,g),A=e.mul(N,p),O=e.add(S,R),B=e.add(m,g);O=e.mul(O,B),B=e.add(F,G),O=e.sub(O,B),B=e.add(S,N);let k=e.add(m,p);return B=e.mul(B,k),k=e.add(F,A),B=e.sub(B,k),k=e.add(R,N),b=e.add(g,p),k=e.mul(k,b),b=e.add(G,A),k=e.sub(k,b),v=e.mul(I,B),b=e.mul(D,A),v=e.add(b,v),b=e.sub(G,v),v=e.add(G,v),y=e.mul(b,v),G=e.add(F,F),G=e.add(G,F),A=e.mul(I,A),B=e.mul(D,B),G=e.add(G,A),A=e.sub(F,A),A=e.mul(I,A),B=e.add(B,A),F=e.mul(G,B),y=e.add(y,F),F=e.mul(k,B),b=e.mul(O,b),b=e.sub(b,F),F=e.mul(O,G),v=e.mul(k,v),v=e.add(v,F),new d(b,y,v)}subtract(_){return this.add(_.negate())}is0(){return this.equals(d.ZERO)}wNAF(_){return T.wNAFCached(this,_,d.normalizeZ)}multiplyUnsafe(_){const{endo:S,n:R}=n;Ae("scalar",_,be,R);const N=d.ZERO;if(_===be)return N;if(this.is0()||_===V)return this;if(!S||T.hasPrecomputes(this))return T.wNAFCachedUnsafe(this,_,d.normalizeZ);let{k1neg:m,k1:g,k2neg:p,k2:b}=S.splitScalar(_),y=N,v=N,I=this;for(;g>be||b>be;)g&V&&(y=y.add(I)),b&V&&(v=v.add(I)),I=I.double(),g>>=V,b>>=V;return m&&(y=y.negate()),p&&(v=v.negate()),v=new d(e.mul(v.px,S.beta),v.py,v.pz),y.add(v)}multiply(_){const{endo:S,n:R}=n;Ae("scalar",_,V,R);let N,m;if(S){const{k1neg:g,k1:p,k2neg:b,k2:y}=S.splitScalar(_);let{p:v,f:I}=this.wNAF(p),{p:D,f:F}=this.wNAF(y);v=T.constTimeNegate(g,v),D=T.constTimeNegate(b,D),D=new d(e.mul(D.px,S.beta),D.py,D.pz),N=v.add(D),m=I.add(F)}else{const{p:g,f:p}=this.wNAF(_);N=g,m=p}return d.normalizeZ([N,m])[0]}multiplyAndAddUnsafe(_,S,R){const N=d.BASE,m=(p,b)=>b===be||b===V||!p.equals(N)?p.multiplyUnsafe(b):p.multiply(b),g=m(this,S).add(m(_,R));return g.is0()?void 0:g}toAffine(_){return f(this,_)}isTorsionFree(){const{h:_,isTorsionFree:S}=n;if(_===V)return!0;if(S)return S(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:_,clearCofactor:S}=n;return _===V?this:S?S(d,this):this.multiplyUnsafe(n.h)}toRawBytes(_=!0){return Fe("isCompressed",_),this.assertValidity(),s(d,this,_)}toHex(_=!0){return Fe("isCompressed",_),Pe(this.toRawBytes(_))}}d.BASE=new d(n.Gx,n.Gy,e.ONE),d.ZERO=new d(e.ZERO,e.ONE,e.ZERO);const E=n.nBitLength,T=fs(d,n.endo?Math.ceil(E/2):E);return{CURVE:n,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:a,isWithinCurveOrder:u}}function ms(t){const n=br(t);return Ze(n,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...n})}function bs(t){const n=ms(t),{Fp:e,n:r}=n,s=e.BYTES+1,o=2*e.BYTES+1;function a(A){return X(A,r)}function u(A){return jt(A,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:h,weierstrassEquation:f,isWithinCurveOrder:l}=_s({...n,toBytes(A,O,B){const k=O.toAffine(),U=e.toBytes(k.x),H=Oe;return Fe("isCompressed",B),B?H(Uint8Array.from([O.hasEvenY()?2:3]),U):H(Uint8Array.from([4]),U,e.toBytes(k.y))},fromBytes(A){const O=A.length,B=A[0],k=A.subarray(1);if(O===s&&(B===2||B===3)){const U=ye(k);if(!qe(U,V,e.ORDER))throw new Error("Point is not on curve");const H=f(U);let Q;try{Q=e.sqrt(H)}catch(ee){const $=ee instanceof Error?": "+ee.message:"";throw new Error("Point is not on curve"+$)}const K=(Q&V)===V;return(B&1)===1!==K&&(Q=e.neg(Q)),{x:U,y:Q}}else if(O===o&&B===4){const U=e.fromBytes(k.subarray(0,e.BYTES)),H=e.fromBytes(k.subarray(e.BYTES,2*e.BYTES));return{x:U,y:H}}else{const U=s,H=o;throw new Error("invalid Point, expected length of "+U+", or uncompressed "+H+", got "+O)}}}),d=A=>Pe(Te(A,n.nByteLength));function E(A){const O=r>>V;return A>O}function T(A){return E(A)?a(-A):A}const C=(A,O,B)=>ye(A.slice(O,B));class _{constructor(O,B,k){this.r=O,this.s=B,this.recovery=k,this.assertValidity()}static fromCompact(O){const B=n.nByteLength;return O=J("compactSignature",O,B*2),new _(C(O,0,B),C(O,B,2*B))}static fromDER(O){const{r:B,s:k}=me.toSig(J("DER",O));return new _(B,k)}assertValidity(){Ae("r",this.r,V,r),Ae("s",this.s,V,r)}addRecoveryBit(O){return new _(this.r,this.s,O)}recoverPublicKey(O){const{r:B,s:k,recovery:U}=this,H=p(J("msgHash",O));if(U==null||![0,1,2,3].includes(U))throw new Error("recovery id invalid");const Q=U===2||U===3?B+n.n:B;if(Q>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");const K=U&1?"03":"02",ue=c.fromHex(K+d(Q)),ee=u(Q),$=a(-H*ee),Ee=a(k*ee),le=c.BASE.multiplyAndAddUnsafe(ue,$,Ee);if(!le)throw new Error("point at infinify");return le.assertValidity(),le}hasHighS(){return E(this.s)}normalizeS(){return this.hasHighS()?new _(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Ue(this.toDERHex())}toDERHex(){return me.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ue(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const S={isValidPrivateKey(A){try{return h(A),!0}catch{return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{const A=gr(n.n);return cs(n.randomBytes(A),n.n)},precompute(A=8,O=c.BASE){return O._setWindowSize(A),O.multiply(BigInt(3)),O}};function R(A,O=!0){return c.fromPrivateKey(A).toRawBytes(O)}function N(A){const O=Ne(A),B=typeof A=="string",k=(O||B)&&A.length;return O?k===s||k===o:B?k===2*s||k===2*o:A instanceof c}function m(A,O,B=!0){if(N(A))throw new Error("first arg must be private key");if(!N(O))throw new Error("second arg must be public key");return c.fromHex(O).multiply(h(A)).toRawBytes(B)}const g=n.bits2int||function(A){if(A.length>8192)throw new Error("input is too large");const O=ye(A),B=A.length*8-n.nBitLength;return B>0?O>>BigInt(B):O},p=n.bits2int_modN||function(A){return a(g(A))},b=en(n.nBitLength);function y(A){return Ae("num < 2^"+n.nBitLength,A,be,b),Te(A,n.nByteLength)}function v(A,O,B=I){if(["recovered","canonical"].some(Z=>Z in B))throw new Error("sign() legacy options not supported");const{hash:k,randomBytes:U}=n;let{lowS:H,prehash:Q,extraEntropy:K}=B;H==null&&(H=!0),A=J("msgHash",A),On(B),Q&&(A=J("prehashed msgHash",k(A)));const ue=p(A),ee=h(O),$=[y(ee),y(ue)];if(K!=null&&K!==!1){const Z=K===!0?U(e.BYTES):K;$.push(J("extraEntropy",Z))}const Ee=Oe(...$),le=ue;function je(Z){const ne=g(Z);if(!l(ne))return;const pe=u(ne),re=c.BASE.multiply(ne).toAffine(),ie=a(re.x);if(ie===be)return;const te=a(pe*a(le+ie*ee));if(te===be)return;let ge=(re.x===ie?0:2)|Number(re.y&V),se=te;return H&&E(te)&&(se=T(te),ge^=1),new _(ie,se,ge)}return{seed:Ee,k2sig:je}}const I={lowS:n.lowS,prehash:!1},D={lowS:n.lowS,prehash:!1};function F(A,O,B=I){const{seed:k,k2sig:U}=v(A,O,B),H=n;return fr(H.hash.outputLen,H.nByteLength,H.hmac)(k,U)}c.BASE._setWindowSize(8);function G(A,O,B,k=D){var ge;const U=A;O=J("msgHash",O),B=J("publicKey",B);const{lowS:H,prehash:Q,format:K}=k;if(On(k),"strict"in k)throw new Error("options.strict was renamed to lowS");if(K!==void 0&&K!=="compact"&&K!=="der")throw new Error("format must be compact or der");const ue=typeof U=="string"||Ne(U),ee=!ue&&!K&&typeof U=="object"&&U!==null&&typeof U.r=="bigint"&&typeof U.s=="bigint";if(!ue&&!ee)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let $,Ee;try{if(ee&&($=new _(U.r,U.s)),ue){try{K!=="compact"&&($=_.fromDER(U))}catch(se){if(!(se instanceof me.Err))throw se}!$&&K!=="der"&&($=_.fromCompact(U))}Ee=c.fromHex(B)}catch{return!1}if(!$||H&&$.hasHighS())return!1;Q&&(O=n.hash(O));const{r:le,s:je}=$,Z=p(O),ne=u(je),pe=a(Z*ne),re=a(le*ne),ie=(ge=c.BASE.multiplyAndAddUnsafe(Ee,pe,re))==null?void 0:ge.toAffine();return ie?a(ie.x)===le:!1}return{CURVE:n,getPublicKey:R,getSharedSecret:m,sign:F,verify:G,ProjectivePoint:c,Signature:_,utils:S}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ys(t){return{hash:t,hmac:(n,...e)=>ur(t,n,Fi(...e)),randomBytes:ar}}function ws(t,n){const e=r=>bs({...t,...ys(r)});return Object.freeze({...e(n),create:e})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Xe=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ot=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Ye=BigInt(1),at=BigInt(2),Ln=(t,n)=>(t+n/at)/n;function yr(t){const n=Xe,e=BigInt(3),r=BigInt(6),s=BigInt(11),o=BigInt(22),a=BigInt(23),u=BigInt(44),c=BigInt(88),h=t*t*t%n,f=h*h*t%n,l=ae(f,e,n)*f%n,d=ae(l,e,n)*f%n,E=ae(d,at,n)*h%n,T=ae(E,s,n)*E%n,C=ae(T,o,n)*T%n,_=ae(C,u,n)*C%n,S=ae(_,c,n)*_%n,R=ae(S,u,n)*C%n,N=ae(R,e,n)*f%n,m=ae(N,a,n)*T%n,g=ae(m,r,n)*h%n,p=ae(g,at,n);if(!Ht.eql(Ht.sqr(p),t))throw new Error("Cannot find square root");return p}const Ht=hr(Xe,void 0,void 0,{sqrt:yr}),tn=ws({a:BigInt(0),b:BigInt(7),Fp:Ht,n:ot,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const n=ot,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Ye*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=e,a=BigInt("0x100000000000000000000000000000000"),u=Ln(o*t,n),c=Ln(-r*t,n);let h=X(t-u*e-c*s,n),f=X(-u*r-c*o,n);const l=h>a,d=f>a;if(l&&(h=n-h),d&&(f=n-f),h>a||f>a)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:h,k2neg:d,k2:f}}}},Ut),wr=BigInt(0),Dn={};function ct(t,...n){let e=Dn[t];if(e===void 0){const r=Ut(Uint8Array.from(t,s=>s.charCodeAt(0)));e=Oe(r,r),Dn[t]=e}return Ut(Oe(e,...n))}const nn=t=>t.toRawBytes(!0).slice(1),Wt=t=>Te(t,32),Ct=t=>X(t,Xe),Ke=t=>X(t,ot),rn=tn.ProjectivePoint,Es=(t,n,e)=>rn.BASE.multiplyAndAddUnsafe(t,n,e);function zt(t){let n=tn.utils.normPrivateKeyToScalar(t),e=rn.fromPrivateKey(n);return{scalar:e.hasEvenY()?n:Ke(-n),bytes:nn(e)}}function Er(t){Ae("x",t,Ye,Xe);const n=Ct(t*t),e=Ct(n*t+BigInt(7));let r=yr(e);r%at!==wr&&(r=Ct(-r));const s=new rn(t,r,Ye);return s.assertValidity(),s}const ke=ye;function Sr(...t){return Ke(ke(ct("BIP0340/challenge",...t)))}function Ss(t){return zt(t).bytes}function xs(t,n,e=ar(32)){const r=J("message",t),{bytes:s,scalar:o}=zt(n),a=J("auxRand",e,32),u=Wt(o^ke(ct("BIP0340/aux",a))),c=ct("BIP0340/nonce",u,s,r),h=Ke(ke(c));if(h===wr)throw new Error("sign failed: k is zero");const{bytes:f,scalar:l}=zt(h),d=Sr(f,s,r),E=new Uint8Array(64);if(E.set(f,0),E.set(Wt(Ke(l+d*o)),32),!xr(E,r,s))throw new Error("sign: Invalid signature produced");return E}function xr(t,n,e){const r=J("signature",t,64),s=J("message",n),o=J("publicKey",e,32);try{const a=Er(ke(o)),u=ke(r.subarray(0,32));if(!qe(u,Ye,Xe))return!1;const c=ke(r.subarray(32,64));if(!qe(c,Ye,ot))return!1;const h=Sr(Wt(u),nn(a),s),f=Es(a,c,Ke(-h));return!(!f||!f.hasEvenY()||f.toAffine().x!==u)}catch{return!1}}const vr={getPublicKey:Ss,sign:xs,verify:xr,utils:{randomPrivateKey:tn.utils.randomPrivateKey,lift_x:Er,pointToBytes:nn,numberToBytesBE:Te,bytesToNumberBE:ye,taggedHash:ct,mod:X}},Cr=(t,n)=>Array(t).fill().map(n),kn="0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz",vs=t=>Cr(t,()=>kn[Math.floor(Math.random()*kn.length)]).join("");vs(20);Promise.all.bind(Promise);const Ar=typeof window<"u";new TextEncoder;new TextDecoder;const Cs=t=>t.reduce((n,e)=>n+e.toString(16).padStart(2,"0"),"");function Tr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var nt={exports:{}},At,Fn;function As(){if(Fn)return At;Fn=1;var t=1e3,n=t*60,e=n*60,r=e*24,s=r*7,o=r*365.25;At=function(f,l){l=l||{};var d=typeof f;if(d==="string"&&f.length>0)return a(f);if(d==="number"&&isFinite(f))return l.long?c(f):u(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))};function a(f){if(f=String(f),!(f.length>100)){var l=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(f);if(l){var d=parseFloat(l[1]),E=(l[2]||"ms").toLowerCase();switch(E){case"years":case"year":case"yrs":case"yr":case"y":return d*o;case"weeks":case"week":case"w":return d*s;case"days":case"day":case"d":return d*r;case"hours":case"hour":case"hrs":case"hr":case"h":return d*e;case"minutes":case"minute":case"mins":case"min":case"m":return d*n;case"seconds":case"second":case"secs":case"sec":case"s":return d*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function u(f){var l=Math.abs(f);return l>=r?Math.round(f/r)+"d":l>=e?Math.round(f/e)+"h":l>=n?Math.round(f/n)+"m":l>=t?Math.round(f/t)+"s":f+"ms"}function c(f){var l=Math.abs(f);return l>=r?h(f,l,r,"day"):l>=e?h(f,l,e,"hour"):l>=n?h(f,l,n,"minute"):l>=t?h(f,l,t,"second"):f+" ms"}function h(f,l,d,E){var T=l>=d*1.5;return Math.round(f/d)+" "+E+(T?"s":"")}return At}var Tt,Pn;function Ts(){if(Pn)return Tt;Pn=1;function t(n){r.debug=r,r.default=r,r.coerce=h,r.disable=u,r.enable=o,r.enabled=c,r.humanize=As(),r.destroy=f,Object.keys(n).forEach(l=>{r[l]=n[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let d=0;for(let E=0;E<l.length;E++)d=(d<<5)-d+l.charCodeAt(E),d|=0;return r.colors[Math.abs(d)%r.colors.length]}r.selectColor=e;function r(l){let d,E=null,T,C;function _(...S){if(!_.enabled)return;const R=_,N=Number(new Date),m=N-(d||N);R.diff=m,R.prev=d,R.curr=N,d=N,S[0]=r.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let g=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(b,y)=>{if(b==="%%")return"%";g++;const v=r.formatters[y];if(typeof v=="function"){const I=S[g];b=v.call(R,I),S.splice(g,1),g--}return b}),r.formatArgs.call(R,S),(R.log||r.log).apply(R,S)}return _.namespace=l,_.useColors=r.useColors(),_.color=r.selectColor(l),_.extend=s,_.destroy=r.destroy,Object.defineProperty(_,"enabled",{enumerable:!0,configurable:!1,get:()=>E!==null?E:(T!==r.namespaces&&(T=r.namespaces,C=r.enabled(l)),C),set:S=>{E=S}}),typeof r.init=="function"&&r.init(_),_}function s(l,d){const E=r(this.namespace+(typeof d>"u"?":":d)+l);return E.log=this.log,E}function o(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];const d=(typeof l=="string"?l:"").trim().replace(" ",",").split(",").filter(Boolean);for(const E of d)E[0]==="-"?r.skips.push(E.slice(1)):r.names.push(E)}function a(l,d){let E=0,T=0,C=-1,_=0;for(;E<l.length;)if(T<d.length&&(d[T]===l[E]||d[T]==="*"))d[T]==="*"?(C=T,_=E,T++):(E++,T++);else if(C!==-1)T=C+1,_++,E=_;else return!1;for(;T<d.length&&d[T]==="*";)T++;return T===d.length}function u(){const l=[...r.names,...r.skips.map(d=>"-"+d)].join(",");return r.enable(""),l}function c(l){for(const d of r.skips)if(a(l,d))return!1;for(const d of r.names)if(a(l,d))return!0;return!1}function h(l){return l instanceof Error?l.stack||l.message:l}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return Tt=t,Tt}var Un;function Rs(){return Un||(Un=1,function(t,n){var e={};n.formatArgs=s,n.save=o,n.load=a,n.useColors=r,n.storage=u(),n.destroy=(()=>{let h=!1;return()=>{h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let h;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(h=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(h[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function s(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const f="color: "+this.color;h.splice(1,0,f,"color: inherit");let l=0,d=0;h[0].replace(/%[a-zA-Z%]/g,E=>{E!=="%%"&&(l++,E==="%c"&&(d=l))}),h.splice(d,0,f)}n.log=console.debug||console.log||(()=>{});function o(h){try{h?n.storage.setItem("debug",h):n.storage.removeItem("debug")}catch{}}function a(){let h;try{h=n.storage.getItem("debug")}catch{}return!h&&typeof process<"u"&&"env"in process&&(h=e.DEBUG),h}function u(){try{return localStorage}catch{}}t.exports=Ts()(n);const{formatters:c}=t.exports;c.j=function(h){try{return JSON.stringify(h)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}(nt,nt.exports)),nt.exports}var Is=Rs();const Ns=Tr(Is),we=typeof window<"u"?window:self,Gt=we.RTCPeerConnection||we.mozRTCPeerConnection||we.webkitRTCPeerConnection,Os=we.RTCSessionDescription||we.mozRTCSessionDescription||we.webkitRTCSessionDescription,Bs=we.RTCIceCandidate||we.mozRTCIceCandidate||we.webkitRTCIceCandidate;var rt={exports:{}},qn;function Ls(){if(qn)return rt.exports;qn=1;var t=typeof Reflect=="object"?Reflect:null,n=t&&typeof t.apply=="function"?t.apply:function(g,p,b){return Function.prototype.apply.call(g,p,b)},e;t&&typeof t.ownKeys=="function"?e=t.ownKeys:Object.getOwnPropertySymbols?e=function(g){return Object.getOwnPropertyNames(g).concat(Object.getOwnPropertySymbols(g))}:e=function(g){return Object.getOwnPropertyNames(g)};function r(m){console&&console.warn&&console.warn(m)}var s=Number.isNaN||function(g){return g!==g};function o(){o.init.call(this)}rt.exports=o,rt.exports.once=S,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function u(m){if(typeof m!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof m)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(m){if(typeof m!="number"||m<0||s(m))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+m+".");a=m}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(g){if(typeof g!="number"||g<0||s(g))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+g+".");return this._maxListeners=g,this};function c(m){return m._maxListeners===void 0?o.defaultMaxListeners:m._maxListeners}o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(g){for(var p=[],b=1;b<arguments.length;b++)p.push(arguments[b]);var y=g==="error",v=this._events;if(v!==void 0)y=y&&v.error===void 0;else if(!y)return!1;if(y){var I;if(p.length>0&&(I=p[0]),I instanceof Error)throw I;var D=new Error("Unhandled error."+(I?" ("+I.message+")":""));throw D.context=I,D}var F=v[g];if(F===void 0)return!1;if(typeof F=="function")n(F,this,p);else for(var G=F.length,A=T(F,G),b=0;b<G;++b)n(A[b],this,p);return!0};function h(m,g,p,b){var y,v,I;if(u(p),v=m._events,v===void 0?(v=m._events=Object.create(null),m._eventsCount=0):(v.newListener!==void 0&&(m.emit("newListener",g,p.listener?p.listener:p),v=m._events),I=v[g]),I===void 0)I=v[g]=p,++m._eventsCount;else if(typeof I=="function"?I=v[g]=b?[p,I]:[I,p]:b?I.unshift(p):I.push(p),y=c(m),y>0&&I.length>y&&!I.warned){I.warned=!0;var D=new Error("Possible EventEmitter memory leak detected. "+I.length+" "+String(g)+" listeners added. Use emitter.setMaxListeners() to increase limit");D.name="MaxListenersExceededWarning",D.emitter=m,D.type=g,D.count=I.length,r(D)}return m}o.prototype.addListener=function(g,p){return h(this,g,p,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(g,p){return h(this,g,p,!0)};function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(m,g,p){var b={fired:!1,wrapFn:void 0,target:m,type:g,listener:p},y=f.bind(b);return y.listener=p,b.wrapFn=y,y}o.prototype.once=function(g,p){return u(p),this.on(g,l(this,g,p)),this},o.prototype.prependOnceListener=function(g,p){return u(p),this.prependListener(g,l(this,g,p)),this},o.prototype.removeListener=function(g,p){var b,y,v,I,D;if(u(p),y=this._events,y===void 0)return this;if(b=y[g],b===void 0)return this;if(b===p||b.listener===p)--this._eventsCount===0?this._events=Object.create(null):(delete y[g],y.removeListener&&this.emit("removeListener",g,b.listener||p));else if(typeof b!="function"){for(v=-1,I=b.length-1;I>=0;I--)if(b[I]===p||b[I].listener===p){D=b[I].listener,v=I;break}if(v<0)return this;v===0?b.shift():C(b,v),b.length===1&&(y[g]=b[0]),y.removeListener!==void 0&&this.emit("removeListener",g,D||p)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(g){var p,b,y;if(b=this._events,b===void 0)return this;if(b.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):b[g]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete b[g]),this;if(arguments.length===0){var v=Object.keys(b),I;for(y=0;y<v.length;++y)I=v[y],I!=="removeListener"&&this.removeAllListeners(I);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(p=b[g],typeof p=="function")this.removeListener(g,p);else if(p!==void 0)for(y=p.length-1;y>=0;y--)this.removeListener(g,p[y]);return this};function d(m,g,p){var b=m._events;if(b===void 0)return[];var y=b[g];return y===void 0?[]:typeof y=="function"?p?[y.listener||y]:[y]:p?_(y):T(y,y.length)}o.prototype.listeners=function(g){return d(this,g,!0)},o.prototype.rawListeners=function(g){return d(this,g,!1)},o.listenerCount=function(m,g){return typeof m.listenerCount=="function"?m.listenerCount(g):E.call(m,g)},o.prototype.listenerCount=E;function E(m){var g=this._events;if(g!==void 0){var p=g[m];if(typeof p=="function")return 1;if(p!==void 0)return p.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};function T(m,g){for(var p=new Array(g),b=0;b<g;++b)p[b]=m[b];return p}function C(m,g){for(;g+1<m.length;g++)m[g]=m[g+1];m.pop()}function _(m){for(var g=new Array(m.length),p=0;p<g.length;++p)g[p]=m[p].listener||m[p];return g}function S(m,g){return new Promise(function(p,b){function y(I){m.removeListener(g,v),b(I)}function v(){typeof m.removeListener=="function"&&m.removeListener("error",y),p([].slice.call(arguments))}N(m,g,v,{once:!0}),g!=="error"&&R(m,y,{once:!0})})}function R(m,g,p){typeof m.on=="function"&&N(m,"error",g,p)}function N(m,g,p,b){if(typeof m.on=="function")b.once?m.once(g,p):m.on(g,p);else if(typeof m.addEventListener=="function")m.addEventListener(g,function y(v){b.once&&m.removeEventListener(g,y),p(v)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof m)}return rt.exports}var Rt,Mn;function Ds(){return Mn||(Mn=1,Rt=typeof queueMicrotask=="function"?queueMicrotask:t=>Promise.resolve().then(t)),Rt}var It,jn;function ks(){return jn||(jn=1,It=class{constructor(n){if(!(n>0)||n-1&n)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(n),this.mask=n-1,this.top=0,this.btm=0,this.next=null}clear(){this.top=this.btm=0,this.next=null,this.buffer.fill(void 0)}push(n){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=n,this.top=this.top+1&this.mask,!0)}shift(){const n=this.buffer[this.btm];if(n!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,n}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}),It}var Nt,Hn;function Fs(){if(Hn)return Nt;Hn=1;const t=ks();return Nt=class{constructor(e){this.hwm=e||16,this.head=new t(this.hwm),this.tail=this.head,this.length=0}clear(){this.head=this.tail,this.head.clear(),this.length=0}push(e){if(this.length++,!this.head.push(e)){const r=this.head;this.head=r.next=new t(2*this.head.buffer.length),this.head.push(e)}}shift(){this.length!==0&&this.length--;const e=this.tail.shift();if(e===void 0&&this.tail.next){const r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}peek(){const e=this.tail.peek();return e===void 0&&this.tail.next?this.tail.next.peek():e}isEmpty(){return this.length===0}},Nt}var Ot,Wn;function zn(){return Wn||(Wn=1,Ot=class{constructor(n){this.decoder=new TextDecoder(n==="utf16le"?"utf16-le":n)}get remaining(){return-1}decode(n){return this.decoder.decode(n,{stream:!0})}flush(){return this.decoder.decode(new Uint8Array(0))}}),Ot}var Bt,Gn;function Ps(){if(Gn)return Bt;Gn=1;const t=zn(),n=zn();Bt=class{constructor(s="utf8"){switch(this.encoding=e(s),this.encoding){case"utf8":this.decoder=new n;break;case"utf16le":case"base64":throw new Error("Unsupported encoding: "+this.encoding);default:this.decoder=new t(this.encoding)}}get remaining(){return this.decoder.remaining}push(s){return typeof s=="string"?s:this.decoder.decode(s)}write(s){return this.push(s)}end(s){let o="";return s&&(o=this.push(s)),o+=this.decoder.flush(),o}};function e(r){switch(r=r.toLowerCase(),r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:throw new Error("Unknown encoding: "+r)}}return Bt}var Lt,Vn;function Us(){if(Vn)return Lt;Vn=1;const{EventEmitter:t}=Ls(),n=new Error("Stream was destroyed"),e=new Error("Premature close"),r=Ds(),s=Fs(),o=Ps(),a=(1<<29)-1,u=1,c=2,h=4,f=8,l=a^u,d=a^c,E=16,T=32,C=64,_=128,S=256,R=512,N=1024,m=2048,g=4096,p=8192,b=16384,y=32768,v=65536,I=131072,D=S|R,F=E|v,G=C|E,A=g|_,O=S|I,B=a^E,k=a^C,U=a^(C|v),H=a^v,Q=a^S,K=a^(_|p),ue=a^N,ee=a^D,$=a^y,Ee=a^T,le=a^I,je=a^O,Z=1<<18,ne=2<<18,pe=4<<18,re=8<<18,ie=16<<18,te=32<<18,ge=64<<18,se=128<<18,ht=256<<18,Re=512<<18,Qe=1024<<18,Fr=a^(Z|ht),on=a^pe,Pr=a^(Z|Re),Ur=a^ie,qr=a^re,an=a^se,Mr=a^ne,cn=a^Qe,He=E|Z,un=a^He,pt=b|te,fe=h|f|c,oe=fe|u,ln=fe|pt,jr=on&k,Je=se|y,Hr=Je&un,fn=oe|Hr,Wr=oe|N|b,dn=oe|b|_,zr=oe|N|_,Gr=oe|g|_|p,Vr=oe|E|N|b|v|I,Yr=fe|N|b,Kr=T|oe|y|C,$r=y|u,Zr=oe|Re|te,Xr=re|ie,hn=re|Z,Qr=re|ie|oe|Z,pn=oe|Z|re|Qe,Jr=pe|Z,ei=Z|ht,ti=oe|Re|hn|te,ni=ie|fe|Re|te,ri=ne|oe|se|pe,ii=Re|te|fe,et=Symbol.asyncIterator||Symbol("asyncIterator");class gn{constructor(i,{highWaterMark:w=16384,map:L=null,mapWritable:P,byteLength:j,byteLengthWritable:M}={}){this.stream=i,this.queue=new s,this.highWaterMark=w,this.buffered=0,this.error=null,this.pipeline=null,this.drains=null,this.byteLength=M||j||Sn,this.map=P||L,this.afterWrite=li.bind(this),this.afterUpdateNextTick=hi.bind(this)}get ended(){return(this.stream._duplexState&te)!==0}push(i){return this.stream._duplexState&ii?!1:(this.map!==null&&(i=this.map(i)),this.buffered+=this.byteLength(i),this.queue.push(i),this.buffered<this.highWaterMark?(this.stream._duplexState|=re,!0):(this.stream._duplexState|=Xr,!1))}shift(){const i=this.queue.shift();return this.buffered-=this.byteLength(i),this.buffered===0&&(this.stream._duplexState&=qr),i}end(i){typeof i=="function"?this.stream.once("finish",i):i!=null&&this.push(i),this.stream._duplexState=(this.stream._duplexState|Re)&on}autoBatch(i,w){const L=[],P=this.stream;for(L.push(i);(P._duplexState&pn)===hn;)L.push(P._writableState.shift());if(P._duplexState&oe)return w(null);P._writev(L,w)}update(){const i=this.stream;i._duplexState|=ne;do{for(;(i._duplexState&pn)===re;){const w=this.shift();i._duplexState|=ei,i._write(w,this.afterWrite)}i._duplexState&Jr||this.updateNonPrimary()}while(this.continueUpdate()===!0);i._duplexState&=Mr}updateNonPrimary(){const i=this.stream;if((i._duplexState&ti)===Re){i._duplexState=i._duplexState|Z,i._final(ui.bind(this));return}if((i._duplexState&fe)===h){i._duplexState&Je||(i._duplexState|=He,i._destroy(_n.bind(this)));return}(i._duplexState&fn)===u&&(i._duplexState=(i._duplexState|He)&l,i._open(mn.bind(this)))}continueUpdate(){return this.stream._duplexState&se?(this.stream._duplexState&=an,!0):!1}updateCallback(){(this.stream._duplexState&ri)===pe?this.update():this.updateNextTick()}updateNextTick(){this.stream._duplexState&se||(this.stream._duplexState|=se,this.stream._duplexState&ne||r(this.afterUpdateNextTick))}}class si{constructor(i,{highWaterMark:w=16384,map:L=null,mapReadable:P,byteLength:j,byteLengthReadable:M}={}){this.stream=i,this.queue=new s,this.highWaterMark=w===0?1:w,this.buffered=0,this.readAhead=w>0,this.error=null,this.pipeline=null,this.byteLength=M||j||Sn,this.map=P||L,this.pipeTo=null,this.afterRead=fi.bind(this),this.afterUpdateNextTick=di.bind(this)}get ended(){return(this.stream._duplexState&b)!==0}pipe(i,w){if(this.pipeTo!==null)throw new Error("Can only pipe to one destination");if(typeof w!="function"&&(w=null),this.stream._duplexState|=R,this.pipeTo=i,this.pipeline=new ai(this.stream,i,w),w&&this.stream.on("error",xn),ze(i))i._writableState.pipeline=this.pipeline,w&&i.on("error",xn),i.on("finish",this.pipeline.finished.bind(this.pipeline));else{const L=this.pipeline.done.bind(this.pipeline,i),P=this.pipeline.done.bind(this.pipeline,i,null);i.on("error",L),i.on("close",P),i.on("finish",this.pipeline.finished.bind(this.pipeline))}i.on("drain",ci.bind(this)),this.stream.emit("piping",i),i.emit("pipe",this.stream)}push(i){const w=this.stream;return i===null?(this.highWaterMark=0,w._duplexState=(w._duplexState|N)&U,!1):this.map!==null&&(i=this.map(i),i===null)?(w._duplexState&=H,this.buffered<this.highWaterMark):(this.buffered+=this.byteLength(i),this.queue.push(i),w._duplexState=(w._duplexState|_)&H,this.buffered<this.highWaterMark)}shift(){const i=this.queue.shift();return this.buffered-=this.byteLength(i),this.buffered===0&&(this.stream._duplexState&=K),i}unshift(i){const w=[this.map!==null?this.map(i):i];for(;this.buffered>0;)w.push(this.shift());for(let L=0;L<w.length-1;L++){const P=w[L];this.buffered+=this.byteLength(P),this.queue.push(P)}this.push(w[w.length-1])}read(){const i=this.stream;if((i._duplexState&dn)===_){const w=this.shift();return this.pipeTo!==null&&this.pipeTo.write(w)===!1&&(i._duplexState&=ee),i._duplexState&m&&i.emit("data",w),w}return this.readAhead===!1&&(i._duplexState|=I,this.updateNextTick()),null}drain(){const i=this.stream;for(;(i._duplexState&dn)===_&&i._duplexState&D;){const w=this.shift();this.pipeTo!==null&&this.pipeTo.write(w)===!1&&(i._duplexState&=ee),i._duplexState&m&&i.emit("data",w)}}update(){const i=this.stream;i._duplexState|=T;do{for(this.drain();this.buffered<this.highWaterMark&&(i._duplexState&Vr)===I;)i._duplexState|=F,i._read(this.afterRead),this.drain();(i._duplexState&Gr)===A&&(i._duplexState|=p,i.emit("readable")),i._duplexState&G||this.updateNonPrimary()}while(this.continueUpdate()===!0);i._duplexState&=Ee}updateNonPrimary(){const i=this.stream;if((i._duplexState&zr)===N&&(i._duplexState=(i._duplexState|b)&ue,i.emit("end"),(i._duplexState&ln)===pt&&(i._duplexState|=h),this.pipeTo!==null&&this.pipeTo.end()),(i._duplexState&fe)===h){i._duplexState&Je||(i._duplexState|=He,i._destroy(_n.bind(this)));return}(i._duplexState&fn)===u&&(i._duplexState=(i._duplexState|He)&l,i._open(mn.bind(this)))}continueUpdate(){return this.stream._duplexState&y?(this.stream._duplexState&=$,!0):!1}updateCallback(){(this.stream._duplexState&Kr)===C?this.update():this.updateNextTick()}updateNextTickIfOpen(){this.stream._duplexState&$r||(this.stream._duplexState|=y,this.stream._duplexState&T||r(this.afterUpdateNextTick))}updateNextTick(){this.stream._duplexState&y||(this.stream._duplexState|=y,this.stream._duplexState&T||r(this.afterUpdateNextTick))}}class oi{constructor(i){this.data=null,this.afterTransform=gi.bind(i),this.afterFinal=null}}class ai{constructor(i,w,L){this.from=i,this.to=w,this.afterPipe=L,this.error=null,this.pipeToFinished=!1}finished(){this.pipeToFinished=!0}done(i,w){if(w&&(this.error=w),i===this.to&&(this.to=null,this.from!==null)){(!(this.from._duplexState&b)||!this.pipeToFinished)&&this.from.destroy(this.error||new Error("Writable stream closed prematurely"));return}if(i===this.from&&(this.from=null,this.to!==null)){i._duplexState&b||this.to.destroy(this.error||new Error("Readable stream closed before ending"));return}this.afterPipe!==null&&this.afterPipe(this.error),this.to=this.from=this.afterPipe=null}}function ci(){this.stream._duplexState|=R,this.updateCallback()}function ui(x){const i=this.stream;x&&i.destroy(x),i._duplexState&fe||(i._duplexState|=te,i.emit("finish")),(i._duplexState&ln)===pt&&(i._duplexState|=h),i._duplexState&=Pr,i._duplexState&ne?this.updateNextTick():this.update()}function _n(x){const i=this.stream;!x&&this.error!==n&&(x=this.error),x&&i.emit("error",x),i._duplexState|=f,i.emit("close");const w=i._readableState,L=i._writableState;if(w!==null&&w.pipeline!==null&&w.pipeline.done(i,x),L!==null){for(;L.drains!==null&&L.drains.length>0;)L.drains.shift().resolve(!1);L.pipeline!==null&&L.pipeline.done(i,x)}}function li(x){const i=this.stream;x&&i.destroy(x),i._duplexState&=Fr,this.drains!==null&&pi(this.drains),(i._duplexState&Qr)===ie&&(i._duplexState&=Ur,(i._duplexState&ge)===ge&&i.emit("drain")),this.updateCallback()}function fi(x){x&&this.stream.destroy(x),this.stream._duplexState&=B,this.readAhead===!1&&!(this.stream._duplexState&S)&&(this.stream._duplexState&=le),this.updateCallback()}function di(){this.stream._duplexState&T||(this.stream._duplexState&=$,this.update())}function hi(){this.stream._duplexState&ne||(this.stream._duplexState&=an,this.update())}function pi(x){for(let i=0;i<x.length;i++)--x[i].writes===0&&(x.shift().resolve(!0),i--)}function mn(x){const i=this.stream;x&&i.destroy(x),i._duplexState&h||(i._duplexState&Wr||(i._duplexState|=C),i._duplexState&Zr||(i._duplexState|=pe),i.emit("open")),i._duplexState&=un,i._writableState!==null&&i._writableState.updateCallback(),i._readableState!==null&&i._readableState.updateCallback()}function gi(x,i){i!=null&&this.push(i),this._writableState.afterWrite(x)}function _i(x){this._readableState!==null&&(x==="data"&&(this._duplexState|=m|O,this._readableState.updateNextTick()),x==="readable"&&(this._duplexState|=g,this._readableState.updateNextTick())),this._writableState!==null&&x==="drain"&&(this._duplexState|=ge,this._writableState.updateNextTick())}class gt extends t{constructor(i){super(),this._duplexState=0,this._readableState=null,this._writableState=null,i&&(i.open&&(this._open=i.open),i.destroy&&(this._destroy=i.destroy),i.predestroy&&(this._predestroy=i.predestroy),i.signal&&i.signal.addEventListener("abort",Ti.bind(this))),this.on("newListener",_i)}_open(i){i(null)}_destroy(i){i(null)}_predestroy(){}get readable(){return this._readableState!==null?!0:void 0}get writable(){return this._writableState!==null?!0:void 0}get destroyed(){return(this._duplexState&f)!==0}get destroying(){return(this._duplexState&fe)!==0}destroy(i){this._duplexState&fe||(i||(i=n),this._duplexState=(this._duplexState|h)&jr,this._readableState!==null&&(this._readableState.highWaterMark=0,this._readableState.error=i),this._writableState!==null&&(this._writableState.highWaterMark=0,this._writableState.error=i),this._duplexState|=c,this._predestroy(),this._duplexState&=d,this._readableState!==null&&this._readableState.updateNextTick(),this._writableState!==null&&this._writableState.updateNextTick())}}class We extends gt{constructor(i){super(i),this._duplexState|=u|te|I,this._readableState=new si(this,i),i&&(this._readableState.readAhead===!1&&(this._duplexState&=le),i.read&&(this._read=i.read),i.eagerOpen&&this._readableState.updateNextTick(),i.encoding&&this.setEncoding(i.encoding))}setEncoding(i){const w=new o(i),L=this._readableState.map||wi;return this._readableState.map=P,this;function P(j){const M=w.push(j);return M===""&&(j.byteLength!==0||w.remaining>0)?null:L(M)}}_read(i){i(null)}pipe(i,w){return this._readableState.updateNextTick(),this._readableState.pipe(i,w),i}read(){return this._readableState.updateNextTick(),this._readableState.read()}push(i){return this._readableState.updateNextTickIfOpen(),this._readableState.push(i)}unshift(i){return this._readableState.updateNextTickIfOpen(),this._readableState.unshift(i)}resume(){return this._duplexState|=O,this._readableState.updateNextTick(),this}pause(){return this._duplexState&=this._readableState.readAhead===!1?je:Q,this}static _fromAsyncIterator(i,w){let L;const P=new We({...w,read(M){i.next().then(j).then(M.bind(null,null)).catch(M)},predestroy(){L=i.return()},destroy(M){if(!L)return M(null);L.then(M.bind(null,null)).catch(M)}});return P;function j(M){M.done?P.push(null):P.push(M.value)}}static from(i,w){if(vi(i))return i;if(i[et])return this._fromAsyncIterator(i[et](),w);Array.isArray(i)||(i=i===void 0?[]:[i]);let L=0;return new We({...w,read(P){this.push(L===i.length?null:i[L++]),P(null)}})}static isBackpressured(i){return(i._duplexState&Yr)!==0||i._readableState.buffered>=i._readableState.highWaterMark}static isPaused(i){return(i._duplexState&S)===0}[et](){const i=this;let w=null,L=null,P=null;return this.on("error",q=>{w=q}),this.on("readable",j),this.on("close",M),{[et](){return this},next(){return new Promise(function(q,de){L=q,P=de;const Se=i.read();Se!==null?Be(Se):i._duplexState&f&&Be(null)})},return(){return Ge(null)},throw(q){return Ge(q)}};function j(){L!==null&&Be(i.read())}function M(){L!==null&&Be(null)}function Be(q){P!==null&&(w?P(w):q===null&&!(i._duplexState&b)?P(n):L({value:q,done:q===null}),P=L=null)}function Ge(q){return i.destroy(q),new Promise((de,Se)=>{if(i._duplexState&f)return de({value:void 0,done:!0});i.once("close",function(){q?Se(q):de({value:void 0,done:!0})})})}}}class bn extends gt{constructor(i){super(i),this._duplexState|=u|b,this._writableState=new gn(this,i),i&&(i.writev&&(this._writev=i.writev),i.write&&(this._write=i.write),i.final&&(this._final=i.final),i.eagerOpen&&this._writableState.updateNextTick())}cork(){this._duplexState|=Qe}uncork(){this._duplexState&=cn,this._writableState.updateNextTick()}_writev(i,w){w(null)}_write(i,w){this._writableState.autoBatch(i,w)}_final(i){i(null)}static isBackpressured(i){return(i._duplexState&ni)!==0}static drained(i){if(i.destroyed)return Promise.resolve(!1);const w=i._writableState,P=(Ri(i)?Math.min(1,w.queue.length):w.queue.length)+(i._duplexState&ht?1:0);return P===0?Promise.resolve(!0):(w.drains===null&&(w.drains=[]),new Promise(j=>{w.drains.push({writes:P,resolve:j})}))}write(i){return this._writableState.updateNextTick(),this._writableState.push(i)}end(i){return this._writableState.updateNextTick(),this._writableState.end(i),this}}class _t extends We{constructor(i){super(i),this._duplexState=u|this._duplexState&I,this._writableState=new gn(this,i),i&&(i.writev&&(this._writev=i.writev),i.write&&(this._write=i.write),i.final&&(this._final=i.final))}cork(){this._duplexState|=Qe}uncork(){this._duplexState&=cn,this._writableState.updateNextTick()}_writev(i,w){w(null)}_write(i,w){this._writableState.autoBatch(i,w)}_final(i){i(null)}write(i){return this._writableState.updateNextTick(),this._writableState.push(i)}end(i){return this._writableState.updateNextTick(),this._writableState.end(i),this}}class yn extends _t{constructor(i){super(i),this._transformState=new oi(this),i&&(i.transform&&(this._transform=i.transform),i.flush&&(this._flush=i.flush))}_write(i,w){this._readableState.buffered>=this._readableState.highWaterMark?this._transformState.data=i:this._transform(i,this._transformState.afterTransform)}_read(i){if(this._transformState.data!==null){const w=this._transformState.data;this._transformState.data=null,i(null),this._transform(w,this._transformState.afterTransform)}else i(null)}destroy(i){super.destroy(i),this._transformState.data!==null&&(this._transformState.data=null,this._transformState.afterTransform())}_transform(i,w){w(null,i)}_flush(i){i(null)}_final(i){this._transformState.afterFinal=i,this._flush(bi.bind(this))}}class mi extends yn{}function bi(x,i){const w=this._transformState.afterFinal;if(x)return w(x);i!=null&&this.push(i),this.push(null),w(null)}function yi(...x){return new Promise((i,w)=>wn(...x,L=>{if(L)return w(L);i()}))}function wn(x,...i){const w=Array.isArray(x)?[...x,...i]:[x,...i],L=w.length&&typeof w[w.length-1]=="function"?w.pop():null;if(w.length<2)throw new Error("Pipeline requires at least 2 streams");let P=w[0],j=null,M=null;for(let q=1;q<w.length;q++)j=w[q],ze(P)?P.pipe(j,Ge):(Be(P,!0,q>1,Ge),P.pipe(j)),P=j;if(L){let q=!1;const de=ze(j)||!!(j._writableState&&j._writableState.autoDestroy);j.on("error",Se=>{M===null&&(M=Se)}),j.on("finish",()=>{q=!0,de||L(M)}),de&&j.on("close",()=>L(M||(q?null:e)))}return j;function Be(q,de,Se,mt){q.on("error",mt),q.on("close",Ii);function Ii(){if(q._readableState&&!q._readableState.ended||Se&&q._writableState&&!q._writableState.ended)return mt(e)}}function Ge(q){if(!(!q||M)){M=q;for(const de of w)de.destroy(q)}}}function wi(x){return x}function En(x){return!!x._readableState||!!x._writableState}function ze(x){return typeof x._duplexState=="number"&&En(x)}function Ei(x){return!!x._readableState&&x._readableState.ended}function Si(x){return!!x._writableState&&x._writableState.ended}function xi(x,i={}){const w=x._readableState&&x._readableState.error||x._writableState&&x._writableState.error;return!i.all&&w===n?null:w}function vi(x){return ze(x)&&x.readable}function Ci(x){return(x._duplexState&u)!==u||(x._duplexState&Je)!==0}function Ai(x){return typeof x=="object"&&x!==null&&typeof x.byteLength=="number"}function Sn(x){return Ai(x)?x.byteLength:1024}function xn(){}function Ti(){this.destroy(new Error("Stream aborted."))}function Ri(x){return x._writev!==bn.prototype._writev&&x._writev!==_t.prototype._writev}return Lt={pipeline:wn,pipelinePromise:yi,isStream:En,isStreamx:ze,isEnded:Ei,isFinished:Si,isDisturbed:Ci,getStreamError:xi,Stream:gt,Writable:bn,Readable:We,Duplex:_t,Transform:yn,PassThrough:mi},Lt}var qs=Us(),Dt,Yn;function Ms(){if(Yn)return Dt;Yn=1;function t(e,r){for(const s in r)Object.defineProperty(e,s,{value:r[s],enumerable:!0,configurable:!0});return e}function n(e,r,s){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");s||(s={}),typeof r=="object"&&(s=r,r=""),r&&(s.code=r);try{return t(e,s)}catch{s.message=e.message,s.stack=e.stack;const a=function(){};return a.prototype=Object.create(Object.getPrototypeOf(e)),t(new a,s)}}return Dt=n,Dt}var js=Ms();const W=Tr(js);/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const Kn="0123456789abcdef",Rr=[];for(let t=0;t<256;t++)Rr[t]=Kn[t>>4&15]+Kn[t&15];const $n=t=>{const n=t.length;let e="",r=0;for(;r<n;)e+=Rr[t[r++]];return e};var Zn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hs=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var it=0;it<Zn.length;it++)Hs[Zn.charCodeAt(it)]=it;new TextDecoder;const Ws=new TextEncoder,zs=t=>Ws.encode(t),Xn=typeof window<"u"?window:self,Vt=Xn.crypto||Xn.msCrypto||{};Vt.subtle||Vt.webkitSubtle;const Qn=t=>{const n=new Uint8Array(t);return Vt.getRandomValues(n)};/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const Gs=Ns("simple-peer"),kt=64*1024,Vs=5*1e3,Ys=5*1e3;function Jn(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function Ks(t){console.warn(t)}let sn=class Yt extends qs.Duplex{constructor(e){e=Object.assign({allowHalfOpen:!1},e);super(e);vn(this,"_pc");if(this.__objectMode=!!e.objectMode,this._id=$n(Qn(4)).slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||$n(Qn(20)):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||Yt.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},Yt.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(r=>r),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||Vs,this._destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,!Gt)throw W(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new Gt(this.config)}catch(r){this.__destroy(W(r,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=r=>{this._onIceCandidate(r)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(r=>{this.__destroy(W(r,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=r=>{this._setupData(r)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this._destroying){if(this.destroyed)throw W(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new Os(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(r=>{this._addIceCandidate(r)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(r=>{this.__destroy(W(r,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.__destroy(W(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const r=new Bs(e);this._pc.addIceCandidate(r).catch(s=>{!r.address||r.address.endsWith(".local")?Ks("Ignoring unsupported ICE candidate."):this.__destroy(W(s,"ERR_ADD_ICE_CANDIDATE"))})}send(e){if(!this._destroying){if(this.destroyed)throw W(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,queueMicrotask(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this._destroying){if(this.destroyed)throw W(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}_final(e){this._readableState.ended||this.push(null),e(null)}__destroy(e){this.end(),this._destroy(()=>{},e)}_destroy(e,r){this.destroyed||this._destroying||(this._destroying=!0,this._debug("destroying (error: %s)",r&&(r.message||r)),setTimeout(()=>{if(this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,r&&this.emit("error",r),e()},0))}_setupData(e){if(!e.channel)return this.__destroy(W(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=kt),this.channelName=this._channel.label,this._channel.onmessage=s=>{this._onChannelMessage(s)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=s=>{const o=s.error instanceof Error?s.error:new Error(`Datachannel error: ${s.message} ${s.filename}:${s.lineno}:${s.colno}`);this.__destroy(W(o,"ERR_DATA_CHANNEL"))};let r=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(r&&this._onChannelClose(),r=!0):r=!1},Ys)}_write(e,r){if(this.destroyed)return r(W(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(s){return this.__destroy(W(s,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>kt?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=r):r(null)}else this._debug("write before connect"),this._chunk=e,this._cb=r}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.__destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Jn(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const r=()=>{if(this.destroyed)return;const a=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:a.type,sdp:a.sdp})},s=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},o=a=>{this.__destroy(W(a,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(s).catch(o)}).catch(e=>{this.__destroy(W(e,"ERR_CREATE_OFFER"))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Jn(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const r=()=>{var u;if(this.destroyed)return;const a=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:a.type,sdp:a.sdp}),this.initiator||(u=this._requestMissingTransceivers)==null||u.call(this)},s=()=>{this.destroyed||(this.trickle||this._iceComplete?r():this.once("_iceComplete",r))},o=a=>{this.__destroy(W(a,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(s).catch(o)}).catch(e=>{this.__destroy(W(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._destroying||this._pc.connectionState==="failed"&&this.__destroy(W(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,r=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,r),this.emit("iceStateChange",e,r),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.__destroy(W(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.__destroy(W(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const r=s=>(Object.prototype.toString.call(s.values)==="[object Array]"&&s.values.forEach(o=>{Object.assign(s,o)}),s);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(s=>{const o=[];s.forEach(a=>{o.push(r(a))}),e(null,o)},s=>e(s)):this._pc.getStats.length>0?this._pc.getStats(s=>{if(this.destroyed)return;const o=[];s.result().forEach(a=>{const u={};a.names().forEach(c=>{u[c]=a.stat(c)}),u.id=a.id,u.type=a.type,u.timestamp=a.timestamp,o.push(r(u))}),e(null,o)},s=>e(s)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this._destroying||this.getStats((r,s)=>{if(this.destroyed||this._destroying)return;r&&(s=[]);const o={},a={},u={};let c=!1;s.forEach(f=>{(f.type==="remotecandidate"||f.type==="remote-candidate")&&(o[f.id]=f),(f.type==="localcandidate"||f.type==="local-candidate")&&(a[f.id]=f),(f.type==="candidatepair"||f.type==="candidate-pair")&&(u[f.id]=f)});const h=f=>{c=!0;let l=a[f.localCandidateId];l&&(l.ip||l.address)?(this.localAddress=l.ip||l.address,this.localPort=Number(l.port)):l&&l.ipAddress?(this.localAddress=l.ipAddress,this.localPort=Number(l.portNumber)):typeof f.googLocalAddress=="string"&&(l=f.googLocalAddress.split(":"),this.localAddress=l[0],this.localPort=Number(l[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let d=o[f.remoteCandidateId];d&&(d.ip||d.address)?(this.remoteAddress=d.ip||d.address,this.remotePort=Number(d.port)):d&&d.ipAddress?(this.remoteAddress=d.ipAddress,this.remotePort=Number(d.portNumber)):typeof f.googRemoteAddress=="string"&&(d=f.googRemoteAddress.split(":"),this.remoteAddress=d[0],this.remotePort=Number(d[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(s.forEach(f=>{f.type==="transport"&&f.selectedCandidatePairId&&h(u[f.selectedCandidatePairId]),(f.type==="googCandidatePair"&&f.googActiveConnection==="true"||(f.type==="candidatepair"||f.type==="candidate-pair")&&f.selected)&&h(f)}),!c&&(!Object.keys(u).length||Object.keys(a).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(l){return this.__destroy(W(l,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const f=this._cb;this._cb=null,f(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>kt||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let r=e.data;r instanceof ArrayBuffer?r=new Uint8Array(r):this.__objectMode===!1&&(r=zs(r)),this.push(r)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.__destroy())}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],Gs.apply(null,e)}};sn.WEBRTC_SUPPORT=!!Gt;sn.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};sn.channelConfig={};[...Cr(5,(t,n)=>`stun:stun${n||""}.l.google.com:19302`)];const $s=Ar&&vr.utils.randomPrivateKey();Ar&&Cs(vr.getPublicKey($s));const er=[{color:"blue",rgba:"rgba(68,255,255,0.6)"},{color:"green",rgba:"rgba(91,250,94,0.6)"},{color:"orange",rgba:"rgba(255,128,0,0.6)"},{color:"purple",rgba:"rgba(173,144,255,0.6)"},{color:"red",rgba:"rgba(255,31,31,0.6)"},{color:"pink",rgba:"rgba(255,166,250,0.6)"}],Zs=()=>er[Math.floor(Math.random()*er.length)],Ir=Zs();function Xs(t){const n=`/cursor-collab-side-project/images/bibata-${t}.svg`;document.body.style.cursor=`url(${n}) 0 0, auto`}Xs(Ir.color);var Qs=typeof global=="object"&&global&&global.Object===Object&&global,Js=typeof self=="object"&&self&&self.Object===Object&&self,Nr=Qs||Js||Function("return this")(),ut=Nr.Symbol,Or=Object.prototype,eo=Or.hasOwnProperty,to=Or.toString,Ve=ut?ut.toStringTag:void 0;function no(t){var n=eo.call(t,Ve),e=t[Ve];try{t[Ve]=void 0;var r=!0}catch{}var s=to.call(t);return r&&(n?t[Ve]=e:delete t[Ve]),s}var ro=Object.prototype,io=ro.toString;function so(t){return io.call(t)}var oo="[object Null]",ao="[object Undefined]",tr=ut?ut.toStringTag:void 0;function Br(t){return t==null?t===void 0?ao:oo:tr&&tr in Object(t)?no(t):so(t)}function co(t){return t!=null&&typeof t=="object"}var uo="[object Symbol]";function lo(t){return typeof t=="symbol"||co(t)&&Br(t)==uo}var fo=/\s/;function ho(t){for(var n=t.length;n--&&fo.test(t.charAt(n)););return n}var po=/^\s+/;function go(t){return t&&t.slice(0,ho(t)+1).replace(po,"")}function Me(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}var nr=NaN,_o=/^[-+]0x[0-9a-f]+$/i,mo=/^0b[01]+$/i,bo=/^0o[0-7]+$/i,yo=parseInt;function Kt(t){if(typeof t=="number")return t;if(lo(t))return nr;if(Me(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=Me(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=go(t);var e=mo.test(t);return e||bo.test(t)?yo(t.slice(2),e?2:8):_o.test(t)?nr:+t}var rr=1/0,wo=17976931348623157e292;function Ft(t){if(!t)return t===0?t:0;if(t=Kt(t),t===rr||t===-rr){var n=t<0?-1:1;return n*wo}return t===t?t:0}var Eo="[object AsyncFunction]",So="[object Function]",xo="[object GeneratorFunction]",vo="[object Proxy]";function Co(t){if(!Me(t))return!1;var n=Br(t);return n==So||n==xo||n==Eo||n==vo}var Ao=9007199254740991,To=/^(?:0|[1-9]\d*)$/;function Ro(t,n){var e=typeof t;return n=n??Ao,!!n&&(e=="number"||e!="symbol"&&To.test(t))&&t>-1&&t%1==0&&t<n}function Io(t,n){return t===n||t!==t&&n!==n}var No=9007199254740991;function Oo(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=No}function Bo(t){return t!=null&&Oo(t.length)&&!Co(t)}function Lo(t,n,e){if(!Me(e))return!1;var r=typeof n;return(r=="number"?Bo(e)&&Ro(n,e.length):r=="string"&&n in e)?Io(e[n],t):!1}var Pt=function(){return Nr.Date.now()},Do="Expected a function",ko=Math.max,Fo=Math.min;function Po(t,n,e){var r,s,o,a,u,c,h=0,f=!1,l=!1,d=!0;if(typeof t!="function")throw new TypeError(Do);n=Kt(n)||0,Me(e)&&(f=!!e.leading,l="maxWait"in e,o=l?ko(Kt(e.maxWait)||0,n):o,d="trailing"in e?!!e.trailing:d);function E(p){var b=r,y=s;return r=s=void 0,h=p,a=t.apply(y,b),a}function T(p){return h=p,u=setTimeout(S,n),f?E(p):a}function C(p){var b=p-c,y=p-h,v=n-b;return l?Fo(v,o-y):v}function _(p){var b=p-c,y=p-h;return c===void 0||b>=n||b<0||l&&y>=o}function S(){var p=Pt();if(_(p))return R(p);u=setTimeout(S,C(p))}function R(p){return u=void 0,d&&r?E(p):(r=s=void 0,a)}function N(){u!==void 0&&clearTimeout(u),h=0,r=c=s=u=void 0}function m(){return u===void 0?a:R(Pt())}function g(){var p=Pt(),b=_(p);if(r=arguments,s=this,c=p,b){if(u===void 0)return T(c);if(l)return clearTimeout(u),u=setTimeout(S,n),E(c)}return u===void 0&&(u=setTimeout(S,n)),a}return g.cancel=N,g.flush=m,g}var Uo=Math.ceil,qo=Math.max;function Mo(t,n,e,r){for(var s=-1,o=qo(Uo((n-t)/(e||1)),0),a=Array(o);o--;)a[++s]=t,t+=e;return a}function jo(t){return function(n,e,r){return r&&typeof r!="number"&&Lo(n,e,r)&&(e=r=void 0),n=Ft(n),e===void 0?(e=n,n=0):e=Ft(e),r=r===void 0?n<e?1:-1:Ft(r),Mo(n,e,r)}}var Ho=jo(),Wo="Expected a function";function Lr(t,n,e){var r=!0,s=!0;if(typeof t!="function")throw new TypeError(Wo);return Me(e)&&(r="leading"in e?!!e.leading:r,s="trailing"in e?!!e.trailing:s),Po(t,n,{leading:r,maxWait:n,trailing:s})}Lr(({currentX:t,currentY:n})=>console.log({currentX:t,currentY:n}),500,{trailing:!0});Lr(zo,50,{trailing:!0});const ir=document.querySelector("#test-cursor"),ce={x:0,y:0},Ce={x:0,y:0};function zo(t){Ce.x=t.clientX,Ce.y=t.clientY,Go()}let $t=!1;function Dr(){ce.x+=(Ce.x-ce.x)*.1,ce.y+=(Ce.y-ce.y)*.1,ir.style.transform=`translate(${ce.x}px, ${ce.y}px)`,Math.hypot(Ce.x-ce.x,Ce.y-ce.y)>.2?requestAnimationFrame(Dr):(ce.x=Ce.x,ce.y=Ce.y,ir.style.transform=`translate(${ce.x}px, ${ce.y}px)`,$t=!1)}function Go(){$t||($t=!0,requestAnimationFrame(Dr))}function Vo(){const t=document.querySelector("#grid");Ho(1,401,1).map((e,r)=>{const s=document.createElement("div");s.classList.add("grid-square"),s.setAttribute("data-id",`${r+1}`),t.appendChild(s)}),t.addEventListener("click",e=>{const r=e.target.closest(".grid-square");r.style.backgroundColor=Ir.rgba,console.log(r.getAttribute("data-id"))})}const sr={"/websocket":()=>1,"/webrtc":()=>1,"/colors":()=>1},kr="/cursor-collab-side-project";function Yo(t){const n=t.replace(kr,"").replace(/^\//,"").substring(1);console.log(n),sr[n]?sr[n]():setTimeout(()=>{console.log("Route not found",t)},1e3)}window.addEventListener("hashchange",()=>{Yo(window.location.hash)});function Ko(t){const n=`${kr}${t}`;window.history.pushState({},"",n)}Ko("/#/websocket");document.querySelector("#app").innerHTML=`
  <header>
    <h1>Cursor collaboration</h1>
    <a href="/cursor-collab-side-project/#/websocket">WebSocket</a>
    <a href="/cursor-collab-side-project/#/webrtc">WebRTC</a>
    <a href="/cursor-collab-side-project/#/colors">Colors</a>

  </header>
  <main>
    <div id="grid"></div>
  </main>

  <h2 id="latency">
    50<span>MS Latency</span>
  </h2>

  <div id="color-picker"></div>
`;Vo();
